(this["webpackJsonpwindmill-dashboard-react"]=this["webpackJsonpwindmill-dashboard-react"]||[]).push([[20],{116:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(1),c=a(40),s=a(45),o=a(17),m=a(44),d=a(11);var i=function(e){let{isOpen:t,onClose:a,onZoneCreated:r}=e;const[s,m]=Object(n.useState)({name:""}),[i,u]=Object(n.useState)(!1),[p,b]=Object(n.useState)({}),E=async e=>{if(e.preventDefault(),(()=>{const e={};return s.name.trim()||(e.name="Zone name is required"),b(e),0===Object.keys(e).length})())try{u(!0);const e=Object(d.a)({},s);await Object(c.e)("/requests/zones/",e),m({name:""}),r&&r(),a()}catch(t){console.error("Error creating zone:",t),t.response&&t.response.data?b(Object(d.a)(Object(d.a)({},p),{},{submit:"Failed to create zone. Please check the form for errors."},t.response.data)):b({submit:"Failed to create zone. Please try again."})}finally{u(!1)}};return l.a.useEffect(()=>{t||(m({name:""}),b({}))},[t]),l.a.createElement(o.Modal,{isOpen:t,onClose:a},l.a.createElement(o.ModalHeader,null,"Add New Zone"),l.a.createElement(o.ModalBody,null,l.a.createElement("form",{onSubmit:E},l.a.createElement("div",{className:"mb-4"},l.a.createElement(o.Label,null,l.a.createElement("span",null,"Zone Name *"),l.a.createElement(o.Input,{className:"mt-1",name:"name",value:s.name,onChange:e=>{const{name:t,value:a}=e.target;m(e=>Object(d.a)(Object(d.a)({},e),{},{[t]:a}))},placeholder:"Enter zone name"}),p.name&&l.a.createElement("span",{className:"text-xs text-red-600"},p.name))),p.submit&&l.a.createElement("div",{className:"mb-4"},l.a.createElement("p",{className:"text-sm text-red-600"},p.submit)))),l.a.createElement(o.ModalFooter,null,l.a.createElement("div",{className:"flex flex-col space-y-2 sm:space-y-0 sm:space-x-2 sm:flex-row"},l.a.createElement(o.Button,{onClick:E,disabled:i},i?"Saving...":"Save Zone"))))};var u=function(e){let{isOpen:t,onClose:a,onZoneUpdated:r,zoneData:s}=e;const[m,i]=Object(n.useState)({name:""}),[u,p]=Object(n.useState)(!1),[b,E]=Object(n.useState)({});Object(n.useEffect)(()=>{s&&i({name:s.name||""})},[s]);const f=async e=>{if(e.preventDefault(),(()=>{const e={};return m.name.trim()||(e.name="Zone name is required"),E(e),0===Object.keys(e).length})())try{p(!0);const e=Object(d.a)({},m);await Object(c.d)("requests/zones/".concat(s.id,"/edit/"),e),r&&r(),a()}catch(t){console.error("Error updating zone:",t),t.response&&t.response.data?E(Object(d.a)(Object(d.a)({},b),{},{submit:"Failed to update zone. Please check the form for errors."},t.response.data)):E({submit:"Failed to update zone. Please try again."})}finally{p(!1)}};return l.a.createElement(o.Modal,{isOpen:t,onClose:a},l.a.createElement(o.ModalHeader,null,"Edit Zone"),l.a.createElement(o.ModalBody,null,l.a.createElement("form",{onSubmit:f},l.a.createElement("div",{className:"mb-4"},l.a.createElement(o.Label,null,l.a.createElement("span",null,"Zone Name *"),l.a.createElement(o.Input,{className:"mt-1",name:"name",value:m.name,onChange:e=>{const{name:t,value:a}=e.target;i(e=>Object(d.a)(Object(d.a)({},e),{},{[t]:a}))},placeholder:"Enter zone name"}),b.name&&l.a.createElement("span",{className:"text-xs text-red-600"},b.name))),b.submit&&l.a.createElement("div",{className:"mb-4"},l.a.createElement("p",{className:"text-sm text-red-600"},b.submit)))),l.a.createElement(o.ModalFooter,null,l.a.createElement("div",{className:"flex flex-col space-y-2 sm:space-y-0 sm:space-x-2 sm:flex-row"},l.a.createElement(o.Button,{onClick:f,disabled:u},u?"Updating...":"Update Zone"))))},p=(a(41),a(18)),b=a.n(p);t.default=function(){Object(r.g)();const[e,t]=Object(n.useState)([]),[a,d]=Object(n.useState)(!0),[p,E]=Object(n.useState)(null),[f,y]=Object(n.useState)(!1),[h,x]=Object(n.useState)(!1),[w,N]=Object(n.useState)(null),[g,v]=Object(n.useState)(0),[j,O]=Object(n.useState)(null);Object(n.useEffect)(()=>{(async()=>{try{d(!0);const e=await Object(c.c)("/requests/zones/");t(e.results)}catch(e){console.error("Error fetching zone data:",e),E("Failed to load zone data")}finally{d(!1)}})()},[g]);const k=e=>{N(e),x(!0),O(null)},C=async e=>{try{window.confirm("Are you sure you want to delete this zone?")&&(await Object(c.a)("requests/zones/".concat(e,"/delete/")),t(t=>t.filter(t=>t.id!==e)),b.a.success("Zone deleted successfully"))}catch(p){console.error("Error deleting zone:",p),b.a.error("Failed to delete zone. Please try again.")}};return l.a.createElement("div",{className:"relative w-full px-4 py-6"},l.a.createElement("div",{className:"relative z-10"},"      ",l.a.createElement("div",{className:"flex items-center justify-between mb-6"},l.a.createElement(s.a,null,"Zones"),l.a.createElement("button",{onClick:()=>{y(!0)},className:"flex items-center bg-purple-600 text-white rounded-lg",style:{fontSize:window.innerWidth<768?"0.875rem":"1rem",padding:window.innerWidth<768?"0.5rem 1rem":"0.75rem 1rem"}},l.a.createElement(m.e,{className:"mr-1 ".concat(window.innerWidth<768?"w-3 h-3":"w-4 h-4")}),"Add Zone")),a?l.a.createElement("div",{className:"flex justify-center my-8"},l.a.createElement("p",{className:"text-gray-700 dark:text-gray-300"},"Loading data...")):p?l.a.createElement("div",{className:"text-center py-8"},l.a.createElement("p",{className:"text-red-600 dark:text-red-400"},p)):l.a.createElement(l.a.Fragment,null,l.a.createElement(o.TableContainer,{className:"hidden md:block mb-8"},l.a.createElement(o.Table,null,l.a.createElement(o.TableHeader,null,l.a.createElement("tr",null,l.a.createElement(o.TableCell,null,"ID"),l.a.createElement(o.TableCell,null,"Name"),l.a.createElement(o.TableCell,null,"Actions"))),l.a.createElement(o.TableBody,null,e.map((e,t)=>l.a.createElement(o.TableRow,{key:e.id},l.a.createElement(o.TableCell,null,l.a.createElement("span",{className:"text-sm font-semibold"},t+1)),l.a.createElement(o.TableCell,null,l.a.createElement("span",{className:"text-sm"},e.name)),l.a.createElement(o.TableCell,null,l.a.createElement("div",{className:"flex items-center space-x-4"},l.a.createElement(o.Button,{layout:"link",size:"icon","aria-label":"Edit",onClick:()=>k(e)},l.a.createElement(m.d,{className:"w-5 h-5","aria-hidden":"true"})),l.a.createElement(o.Button,{layout:"link",size:"icon","aria-label":"Delete",onClick:()=>C(e.id)},l.a.createElement(m.b,{className:"w-5 h-5","aria-hidden":"true"}))))))))),l.a.createElement("div",{className:"md:hidden space-y-3"},0===e.length?l.a.createElement("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400"},"No zones found"):e.map((e,t)=>l.a.createElement("div",{key:e.id,className:"bg-white dark:bg-gray-800 rounded-lg border dark:border-gray-700 hover:border-purple-200 dark:hover:border-purple-700 transition-colors",onClick:()=>{return t=e.id,void O(j===t?null:t);var t}},l.a.createElement("div",{className:"flex items-center p-3"},l.a.createElement("div",{className:"h-12 w-12 mr-3 rounded-full bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-300 \r flex items-center justify-center font-medium"},t+1),l.a.createElement("div",{className:"flex-1 min-w-0"},l.a.createElement("div",{className:"flex items-center justify-between"},l.a.createElement("p",{className:"font-medium dark:text-white truncate"},e.name))),l.a.createElement("button",{className:"text-gray-600 dark:text-gray-300"},j===e.id?l.a.createElement(m.g,{className:"h-5 w-5"}):l.a.createElement(m.c,{className:"h-5 w-5"}))),j===e.id&&l.a.createElement("div",{className:"px-4 pb-4 pt-0 border-t dark:border-gray-700"},l.a.createElement("div",{className:"mt-2"},l.a.createElement("div",{className:"flex justify-end space-x-2 mt-2"},l.a.createElement("button",{onClick:()=>k(e),className:"bg-blue-600 text-white px-3 py-1 rounded-md text-xs flex items-center"},l.a.createElement(m.d,{className:"mr-1 h-3 w-3"})," Edit"),l.a.createElement("button",{onClick:()=>C(e.id),className:"bg-red-600 text-white px-3 py-1 rounded-md text-xs flex items-center"},l.a.createElement(m.b,{className:"mr-1 h-3 w-3"})," Delete")))))))),l.a.createElement(i,{isOpen:f,onClose:()=>{y(!1)},onZoneCreated:()=>{v(e=>e+1),b.a.success("Zone created successfully")}}),w&&l.a.createElement(u,{isOpen:h,onClose:()=>{x(!1),N(null)},onZoneUpdated:()=>{v(e=>e+1),b.a.success("Zone updated successfully")},zoneData:w})))}},40:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"d",(function(){return m})),a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return i})),a.d(t,"g",(function(){return u}));var n=a(109);let l="https://rms-v2.duckdns.org/api";console.log("Running in Production Mode"),l="http://35.172.211.35/api";const r=n.a.create({baseURL:l,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{const t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,async e=>(e.response&&401===e.response.status&&(localStorage.clear(),window.location.href="/"),Promise.reject(e)));const c=async(e,t)=>r.get(e,{params:t}).then(e=>e.data),s=async(e,t)=>r.post(e,t).then(e=>e.data),o=async(e,t)=>r.put(e,t).then(e=>e.data),m=async(e,t)=>r.patch(e,t).then(e=>e.data),d=async e=>r.delete(e).then(e=>e.data),i=async(e,t)=>{try{const a=await r.get(e,{responseType:"blob"}),n=new Blob([a.data],{type:"application/pdf"}),l=window.URL.createObjectURL(n),c=document.createElement("a");c.href=l,c.setAttribute("download",t),document.body.appendChild(c),c.click(),c.remove(),window.URL.revokeObjectURL(l)}catch(a){throw console.error("Download failed:",a),a}},u=async(e,t)=>{try{return(await r.post(e,t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(a){throw console.error("File upload failed:",a),a}}},45:function(e,t,a){"use strict";var n=a(0),l=a.n(n);t.a=function(e){let{children:t}=e;return l.a.createElement("h1",{className:"my-6 text-2xl font-semibold text-gray-700 dark:text-gray-200"},t)}}}]);
//# sourceMappingURL=20.5bf820be.chunk.js.map