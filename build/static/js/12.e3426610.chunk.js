(this["webpackJsonpwindmill-dashboard-react"]=this["webpackJsonpwindmill-dashboard-react"]||[]).push([[12],{104:function(a,e,t){"use strict";t.r(e);var n=t(11),r=t(0),l=t.n(r),c=t(1),i=t(40),s=t(45),o=t(52),d=t(17),m=t(18),u=t(44);e.default=()=>{const{id:a}=Object(c.i)(),e=Object(c.g)(),[t,p]=Object(r.useState)(!1),[h,b]=Object(r.useState)({miqaat_name:"",miqaat_date:"",hijri_date:"",miqaat_type:"general_miqaats",description:""}),f=a=>{const e=new Date(a);if(isNaN(e.getTime()))return"";const t=new Date(2025,2,13),n=1446,r=9,l=14,c=Math.floor((e-t)/864e5);let i=n+Math.floor(c/354),s=r,o=l+c%354;const d=[30,29,30,29,30,29,30,30,29,30,29,30];for(;o>d[s-1];)o-=d[s-1],s++,s>12&&(s=1,i++);for(;o<1;)s--,s<1&&(s=12,i--),o+=d[s-1];return"".concat(o," ").concat(["Moharramul Haram","Safarul Muzaffar","Rabiul Awwal","Rabiul Akhar","Jumadil Ula","Jumadal Ukhra","Rajabal Asab","Shabanul Karim","Ramadanal Moazzam","Shawwalul Mukarram","Ziqadatil Haram","Zilhajatil Haram"][s-1]," ").concat(i)};Object(r.useEffect)(()=>{if(h.miqaat_date){const a=f(h.miqaat_date);b(e=>Object(n.a)(Object(n.a)({},e),{},{hijri_date:a}))}},[h.miqaat_date]),Object(r.useEffect)(()=>{(async()=>{try{const e=await Object(i.c)("/miqaat/".concat(a,"/")),t=e.miqaat_date?new Date(e.miqaat_date).toISOString().split("T")[0]:"";if(b({miqaat_name:e.miqaat_name||"",miqaat_date:t,hijri_date:e.hijri_date||"",miqaat_type:e.miqaat_type||"general_miqaats",description:e.description||"",thaals_polled:e.thaals_polled||0,thaals_cooked:e.thaals_cooked||0,thaals_served:e.thaals_served||0}),t&&!e.hijri_date){const a=f(t);b(e=>Object(n.a)(Object(n.a)({},e),{},{hijri_date:a}))}}catch(e){console.error("Error fetching Miqaat data:",e),m.toast.error("Failed to load Miqaat data")}})()},[a]);const q=a=>{const{name:e,value:t}=a.target;"hijri_date"!==e&&b(a=>Object(n.a)(Object(n.a)({},a),{},{[e]:t}))};return l.a.createElement(l.a.Fragment,null,l.a.createElement(s.a,null," ",l.a.createElement("button",{onClick:()=>{e.goBack()},className:"mr-4"},l.a.createElement(u.a,{className:"w-5 h-5 dark:text-white"}))," Edit Miqaat"),l.a.createElement("form",{onSubmit:async t=>{t.preventDefault(),p(!0);try{const t=Object(n.a)(Object(n.a)({},h),{},{thaals_polled:parseInt(h.thaals_polled)||0,thaals_cooked:parseInt(h.thaals_cooked)||0,thaals_served:parseInt(h.thaals_served)||0});await Object(i.d)("/miqaat/".concat(a,"/"),t),m.toast.success("Miqaat updated successfully"),e.push("/app/tables?miqaat_type=".concat(h.miqaat_type))}catch(r){console.error("Error updating Miqaat:",r),m.toast.error("Failed to update Miqaat")}finally{p(!1)}}},l.a.createElement(o.a,null,"Miqaat Details"),l.a.createElement("div",{className:"px-4 py-6 mb-8 bg-white rounded-lg shadow-md dark:bg-gray-800 grid grid-cols-1 md:grid-cols-2 gap-6"},l.a.createElement(d.Label,null,l.a.createElement("span",null,"Miqaat Name"),l.a.createElement(d.Input,{className:"mt-1",name:"miqaat_name",value:h.miqaat_name,onChange:q,placeholder:"Enter miqaat name",required:!0})),l.a.createElement(d.Label,null,l.a.createElement("span",null,"Miqaat Date"),l.a.createElement(d.Input,{type:"date",className:"mt-1",name:"miqaat_date",value:h.miqaat_date,onChange:q,required:!0})),l.a.createElement(d.Label,null,l.a.createElement("span",null,"Hijri Date"),l.a.createElement(d.Input,{className:"mt-1",name:"hijri_date",value:h.hijri_date,readOnly:!0,disabled:!0,placeholder:"Automatically calculated from Miqaat Date"})),l.a.createElement(d.Label,null,l.a.createElement("span",null,"Miqaat Type"),l.a.createElement(d.Select,{className:"mt-1",name:"miqaat_type",value:h.miqaat_type,onChange:q,required:!0},l.a.createElement("option",{value:"general_miqaats"},"General Miqaats"),l.a.createElement("option",{value:"private_events"},"Private Events"),l.a.createElement("option",{value:"ramadan"},"Ramadan"))),l.a.createElement("div",{className:"md:col-span-2"},l.a.createElement(d.Label,null,l.a.createElement("span",null,"Description"),l.a.createElement(d.Textarea,{className:"mt-1",rows:"4",name:"description",value:h.description,onChange:q,placeholder:"Enter miqaat description"}))),l.a.createElement("div",{className:"md:col-span-2 flex justify-center md:justify-end mt-6"},l.a.createElement(d.Button,{type:"submit",disabled:t},t?"Updating...":"Update Miqaat")))))}},40:function(a,e,t){"use strict";t.d(e,"c",(function(){return c})),t.d(e,"e",(function(){return i})),t.d(e,"f",(function(){return s})),t.d(e,"d",(function(){return o})),t.d(e,"a",(function(){return d})),t.d(e,"b",(function(){return m})),t.d(e,"g",(function(){return u}));var n=t(109);let r="https://rms-v2.duckdns.org/api";console.log("Running in Production Mode"),r="https://rms-v2.duckdns.org/api";const l=n.a.create({baseURL:r,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(a=>{const e=localStorage.getItem("accessToken");return e&&(a.headers.Authorization="Bearer ".concat(e)),a},a=>Promise.reject(a)),l.interceptors.response.use(a=>a,async a=>(a.response&&401===a.response.status&&(localStorage.clear(),window.location.href="/"),Promise.reject(a)));const c=async(a,e)=>l.get(a,{params:e}).then(a=>a.data),i=async(a,e)=>l.post(a,e).then(a=>a.data),s=async(a,e)=>l.put(a,e).then(a=>a.data),o=async(a,e)=>l.patch(a,e).then(a=>a.data),d=async a=>l.delete(a).then(a=>a.data),m=async(a,e)=>{try{const t=await l.get(a,{responseType:"blob"}),n=new Blob([t.data],{type:"application/pdf"}),r=window.URL.createObjectURL(n),c=document.createElement("a");c.href=r,c.setAttribute("download",e),document.body.appendChild(c),c.click(),c.remove(),window.URL.revokeObjectURL(r)}catch(t){throw console.error("Download failed:",t),t}},u=async(a,e)=>{try{return(await l.post(a,e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){throw console.error("File upload failed:",t),t}}},45:function(a,e,t){"use strict";var n=t(0),r=t.n(n);e.a=function(a){let{children:e}=a;return r.a.createElement("h1",{className:"my-6 text-2xl font-semibold text-gray-700 dark:text-gray-200"},e)}},52:function(a,e,t){"use strict";var n=t(0),r=t.n(n);e.a=function(a){let{children:e}=a;return r.a.createElement("h2",{className:"mb-4 text-lg font-semibold text-gray-600 dark:text-gray-300"},e)}}}]);
//# sourceMappingURL=12.e3426610.chunk.js.map