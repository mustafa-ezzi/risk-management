{"version":3,"sources":["api/axios.js","pages/registration.js"],"names":["BASE_URL","console","log","axiosInstance","axios","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","concat","error","Promise","reject","response","async","status","clear","window","location","href","get","url","params","then","res","data","post","put","patch","_delete","delete","downloadBlob","filename","responseType","blob","Blob","type","blobUrl","URL","createObjectURL","link","document","createElement","setAttribute","body","appendChild","click","remove","revokeObjectURL","err","uploadFormData","formData","MiqaatRegistrationPage","miqaat_id","useParams","its","setIts","useState","miqaatName","setMiqaatName","isSubmitting","setIsSubmitting","setError","useEffect","miqaat_name","fetchMiqaatName","history","useHistory","React","className","style","backgroundImage","backgroundColor","backdropFilter","WebkitBackdropFilter","src","logo","alt","onSubmit","e","preventDefault","toast","success","message","Label","Input","value","onChange","target","required","placeholder","disabled","onClick","handleNavigate","push"],"mappings":"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","file":"static/js/32.c31db8d8.chunk.js","sourcesContent":["import axios from \"axios\";\r\n\r\n// let BASE_URL = \"http://35.172.211.35/api\";\r\nlet BASE_URL = \"https://rms-v2.duckdns.org/api\";\r\n\r\n\r\n\r\nif (process.env.NODE_ENV === \"production\") {\r\n  console.log(\"Running in Production Mode\");\r\n  BASE_URL = \"https://rms-v2.duckdns.org/api\";\r\n} else {\r\n  // BASE_URL = \"http://localhost:8000/api/v1\";\r\n  console.log(\"Running in Development Mode\");\r\n}\r\n\r\nconst axiosInstance = axios.create({\r\n  baseURL: BASE_URL,\r\n  headers: {\r\n    \"Content-Type\": \"application/json\",\r\n  },\r\n});\r\n\r\naxiosInstance.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem(\"accessToken\");\r\n    if (token) {\r\n      config.headers[\"Authorization\"] = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\naxiosInstance.interceptors.response.use(\r\n  (response) => response,\r\n  async (error) => {\r\n    // await logErrorToBackend(error);\r\n    if (error.response && error.response.status === 401) {\r\n      localStorage.clear();\r\n      window.location.href = \"/\";\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport const get = async (url, params) => {\r\n  return axiosInstance.get(url, { params }).then((res) => res.data);\r\n};\r\n\r\nexport const post = async (url, data) => {\r\n  return axiosInstance.post(url, data).then((res) => res.data);\r\n};\r\n\r\nexport const put = async (url, data) => {\r\n  return axiosInstance.put(url, data).then((res) => res.data);\r\n};\r\n\r\nexport const patch = async (url, data) => {\r\n  return axiosInstance.patch(url, data).then((res) => res.data);\r\n};\r\n\r\nexport const _delete = async (url) => {\r\n  return axiosInstance.delete(url).then((res) => res.data);\r\n};\r\n\r\nexport const downloadBlob = async (url, filename) => {\r\n  try {\r\n    const response = await axiosInstance.get(url, {\r\n      responseType: \"blob\",\r\n    });\r\n\r\n    const blob = new Blob([response.data], { type: \"application/pdf\" });\r\n    const blobUrl = window.URL.createObjectURL(blob);\r\n\r\n    const link = document.createElement(\"a\");\r\n    link.href = blobUrl;\r\n    link.setAttribute(\"download\", filename);\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    link.remove();\r\n    window.URL.revokeObjectURL(blobUrl);\r\n  } catch (err) {\r\n    console.error(\"Download failed:\", err);\r\n    throw err;\r\n  }\r\n};\r\n\r\nexport const uploadFormData = async (url, formData) => {\r\n  try {\r\n    const response = await axiosInstance.post(url, formData, {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    });\r\n    return response.data;\r\n  } catch (err) {\r\n    console.error(\"File upload failed:\", err);\r\n    throw err;\r\n  }\r\n};\r\n\r\nexport default axiosInstance;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { Input, Label, Button } from '@windmill/react-ui';\r\nimport { get, post } from '../api/axios';\r\nimport toast from 'react-hot-toast';\r\nimport { AiOutlineSearch } from 'react-icons/ai';\r\nimport { useHistory } from 'react-router-dom';\r\nimport logo from '../assets/img/mainLogo.png';\r\n\r\nfunction MiqaatRegistrationPage() {\r\n    const { miqaat_id } = useParams();\r\n    const [its, setIts] = useState('');\r\n    const [miqaatName, setMiqaatName] = useState('');\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    useEffect(() => {\r\n        const fetchMiqaatName = async () => {\r\n            try {\r\n                const response = await get(`/miqaat/${miqaat_id}/`);\r\n                setMiqaatName(response?.miqaat_name || 'Unknown Miqaat');\r\n            } catch (err) {\r\n                setError(err.error || 'An unexpected error occurred. Please try again.');\r\n            }\r\n        };\r\n\r\n        fetchMiqaatName();\r\n    }, [miqaat_id]);\r\n\r\n\r\n    const history = useHistory();\r\n\r\n    const handleNavigate = () => {\r\n        history.push('/miqaat/history');\r\n    };\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setIsSubmitting(true);\r\n\r\n        try {\r\n            const res = await post('/miqaat/register/', {\r\n                its,\r\n                miqaat_id,\r\n            });\r\n            toast.success(res.message || 'Registered successfully!');\r\n            setIts('');\r\n        } catch (err) {\r\n            setError(err.error || 'An unexpected error occurred. Please try again.');\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n<div\r\n    className=\"relative min-h-screen bg-cover bg-center\"\r\n    style={{ backgroundImage: \"url('/rice.jpg')\" }}\r\n>\r\n    {/* CONTENT */}\r\n    <div className=\"relative z-10 flex  items-center justify-center min-h-screen px-4 py-12\">\r\n<div\r\n  className=\"w-full max-w-xl rounded-2xl shadow-xl p-10 sm:p-4 h-auto min-h-[450px] relative overflow-hidden\"\r\n  style={{\r\n    backgroundColor: 'rgba(255, 255, 255, 0.4)',\r\n    backdropFilter: 'blur(10px)',\r\n    WebkitBackdropFilter: 'blur(10px)',\r\n  }}\r\n>\r\n            <div className=\"flex justify-center items-center\">\r\n                 <img src={logo} alt=\"Logo\" className=\"h-25 w-auto\"  />\r\n            </div>\r\n            {/* Heading */}\r\n            <div className=\"text-center mb-6\">\r\n                <h1 className=\"text-3xl font-bold text-gray-800 \">\r\n                    Miqaat Registration\r\n                </h1>\r\n                <p className=\"mt-2 text-gray-600\">\r\n                    Miqaat:{' '}\r\n                    <span className=\"font-semibold text-purple-700 \">\r\n                        {miqaatName}\r\n                    </span>\r\n                </p>\r\n            </div>\r\n\r\n            {/* Form */}\r\n            <form\r\n  onSubmit={handleSubmit}\r\n  className=\"flex flex-col sm:flex-row items-center gap-3 mb-8 justify-center w-full\"\r\n>\r\n  <Label className=\"block text-gray-100 dark:text-gray-300 w-full sm:w-auto\">\r\n    <div className=\"relative mt-1\">\r\n      <Input\r\n        type=\"text\"\r\n        value={its}\r\n        onChange={(e) => setIts(e.target.value)}\r\n        required\r\n        placeholder=\"Enter your ITS number\"\r\n        className=\"w-full sm:w-64  rounded-lg border border-gray-300 dark:border-gray-600 bg-white/50 dark:bg-gray-800/50 px-3 py-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-200\"\r\n      />\r\n    </div>\r\n  </Label>\r\n\r\n  <button\r\n    type=\"submit\"\r\n    disabled={isSubmitting}\r\n    className=\"w-full sm:min-w-[160px] sm:w-auto flex items-center justify-center bg-indigo-600 text-white px-4 py-2 rounded-lg shadow-md text-sm font-medium transition-all duration-200 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap\"\r\n  >\r\n    {isSubmitting ? 'Submitting...' : 'Register'}\r\n  </button>\r\n\r\n  <button\r\n    onClick={handleNavigate}\r\n    type=\"button\"\r\n    className=\"w-full sm:min-w-[160px] sm:w-auto flex items-center justify-center bg-indigo-600 text-white px-4 py-2 rounded-lg shadow-md text-sm font-medium transition-all duration-200 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap\"\r\n  >\r\n    Attendance History\r\n  </button>\r\n</form>\r\n\r\n            {error && (\r\n                <p className=\"text-red-700 text-lg text-center mb-6 font-large animate-pulse\">{error}</p>\r\n            )}\r\n        </div>\r\n    </div>\r\n</div>\r\n    );\r\n\r\n\r\n}\r\n\r\nexport default MiqaatRegistrationPage;\r\n"],"sourceRoot":""}