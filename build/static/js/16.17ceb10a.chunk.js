(this["webpackJsonpwindmill-dashboard-react"]=this["webpackJsonpwindmill-dashboard-react"]||[]).push([[16],{117:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(1),c=a(40),s=a(45),o=a(17),i=a(44),m=a(11),d=a(18),u=a.n(d);var b=e=>{let{isOpen:t,onClose:a,onCityCreated:s}=e;const i=Object(l.g)(),[u,b]=Object(n.useState)({name:""}),[y,p]=Object(n.useState)(!1);Object(n.useEffect)(()=>{t&&b({name:""})},[t]);const E=async e=>{if(e.preventDefault(),p(!0),!u.name.trim())return d.toast.error("City name is required"),void p(!1);try{const e={name:u.name.trim()};await Object(c.e)("requests/cities/",e);d.toast.success("City created successfully"),a(),s(),i.push("/app/city")}catch(r){var t,n;console.error("Error creating city:",r),d.toast.error((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Failed to create city")}finally{p(!1)}};return r.a.createElement(o.Modal,{isOpen:t,onClose:a},r.a.createElement(o.ModalHeader,null,"Create New City"),r.a.createElement(o.ModalBody,null,r.a.createElement("form",{onSubmit:E},r.a.createElement(o.Label,{className:"block mb-4"},r.a.createElement("span",null,"City Name"),r.a.createElement(o.Input,{className:"mt-1",name:"name",value:u.name,onChange:e=>{const{name:t,value:a}=e.target;b(e=>Object(m.a)(Object(m.a)({},e),{},{[t]:a}))},placeholder:"Enter city name",required:!0})))),r.a.createElement(o.ModalFooter,null,r.a.createElement("div",{className:"hidden sm:block"},r.a.createElement(o.Button,{onClick:E,disabled:y},y?"Creating...":"Create City")),r.a.createElement("div",{className:"w-full sm:hidden"},r.a.createElement(o.Button,{block:!0,size:"large",onClick:E,disabled:y},y?"Creating...":"Create City"))))};var y=function(e){let{isOpen:t,onClose:a,onCityUpdated:l,cityData:s}=e;const[i,d]=Object(n.useState)({name:""}),[u,b]=Object(n.useState)(!1),[y,p]=Object(n.useState)({});Object(n.useEffect)(()=>{s&&d({name:s.name||""})},[s]);const E=async e=>{if(e.preventDefault(),(()=>{const e={};return i.name.trim()||(e.name="City name is required"),p(e),0===Object.keys(e).length})())try{b(!0),await Object(c.d)("/requests/cities/".concat(s.id,"/edit/"),i),l&&l(),a()}catch(t){console.error("Error updating city:",t),p({submit:"Failed to update city. Please try again."})}finally{b(!1)}};return r.a.createElement(o.Modal,{isOpen:t,onClose:a},r.a.createElement(o.ModalHeader,null,"Edit City Item"),r.a.createElement(o.ModalBody,null,r.a.createElement("form",{onSubmit:E},r.a.createElement("div",{className:"mb-4"},r.a.createElement(o.Label,null,r.a.createElement("span",null,"City Name"),r.a.createElement(o.Input,{className:"mt-1",name:"name",value:i.name,onChange:e=>{const{name:t,value:a}=e.target;d(e=>Object(m.a)(Object(m.a)({},e),{},{[t]:a}))},placeholder:"Enter city name"}),y.name&&r.a.createElement("span",{className:"text-xs text-red-600"},y.name))),y.submit&&r.a.createElement("div",{className:"mb-4"},r.a.createElement("p",{className:"text-sm text-red-600"},y.submit)))),r.a.createElement(o.ModalFooter,null,r.a.createElement("div",{className:"flex flex-col space-y-2 sm:space-y-0 sm:space-x-2 sm:flex-row"},r.a.createElement(o.Button,{onClick:E,disabled:u},u?"Updating...":"Update City"))))};a(41);t.default=function(){Object(l.g)();const[e,t]=Object(n.useState)([]),[a,m]=Object(n.useState)(!0),[d,p]=Object(n.useState)(null),[E,h]=Object(n.useState)(!1),[g,f]=Object(n.useState)(!1),[x,v]=Object(n.useState)(null),[C,w]=Object(n.useState)(0);Object(n.useEffect)(()=>{(async()=>{try{m(!0);const e=await Object(c.c)("requests/cities/");t(e.results)}catch(e){console.error("Error fetching city data:",e),p("Failed to load city data")}finally{m(!1)}})()},[C]);const N=e=>{v(e),f(!0)},k=async e=>{try{window.confirm("Are you sure you want to delete this city item?")&&(await Object(c.a)("requests/cities/".concat(e,"/delete/")),t(t=>t.filter(t=>t.id!==e)),u.a.success("City deleted successfully"))}catch(d){console.error("Error deleting city:",d),u.a.error("Failed to delete city. Please try again.")}};return r.a.createElement("div",{className:"relative w-full px-4 py-6"},r.a.createElement("div",{className:"relative z-10"},r.a.createElement("div",{className:"flex items-center justify-between mb-6"},r.a.createElement(s.a,null,"City List"),r.a.createElement("button",{onClick:()=>{h(!0)},className:"flex items-center bg-purple-600 hover:bg-purple-700 text-white rounded-lg dark:bg-purple-700 dark:hover:bg-purple-600",style:{fontSize:window.innerWidth<768?"0.875rem":"1rem",padding:window.innerWidth<768?"0.5rem 1rem":"0.75rem 1rem"}},r.a.createElement(i.e,{className:"mr-1 ".concat(window.innerWidth<768?"w-3 h-3":"w-4 h-4")}),"Add City")),a?r.a.createElement("div",{className:"flex justify-center my-8"},r.a.createElement("p",{className:"text-gray-700 dark:text-gray-300"},"Loading data...")):d?r.a.createElement("div",{className:"text-center py-8"},r.a.createElement("p",{className:"text-red-600 dark:text-red-400"},d)):r.a.createElement(r.a.Fragment,null,r.a.createElement(o.TableContainer,{className:"hidden md:block mb-8"},r.a.createElement(o.Table,null,r.a.createElement(o.TableHeader,null,r.a.createElement("tr",null,r.a.createElement(o.TableCell,null,"ID"),r.a.createElement(o.TableCell,null,"Name"),r.a.createElement(o.TableCell,null,"Actions"))),r.a.createElement(o.TableBody,null,e.map((e,t)=>r.a.createElement(o.TableRow,{key:e.id,className:"dark:bg-gray-800 dark:hover:bg-gray-700"},r.a.createElement(o.TableCell,null,r.a.createElement("span",{className:"text-sm font-semibold dark:text-white"},t+1)),r.a.createElement(o.TableCell,null,r.a.createElement("span",{className:"text-sm dark:text-white"},e.name)),r.a.createElement(o.TableCell,null,r.a.createElement("div",{className:"flex items-center space-x-4"},r.a.createElement("button",{onClick:()=>N(e),className:"text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400"},r.a.createElement(i.d,{className:"h-4 w-4"})),r.a.createElement("button",{onClick:()=>k(e.id),className:"text-gray-600 hover:text-red-600 dark:text-gray-300 dark:hover:text-red-400"},r.a.createElement(i.b,{className:"h-4 w-4"}))))))))),r.a.createElement("div",{className:"md:hidden space-y-3"},0===e.length?r.a.createElement("div",{className:"text-center py-8"},r.a.createElement("p",{className:"text-gray-700 dark:text-gray-300"},"No city items found")):e.map((e,t)=>r.a.createElement("div",{key:e.id,className:"bg-white dark:bg-gray-800 rounded-lg shadow-md border dark:border-gray-700 p-4"},r.a.createElement("div",{className:"flex justify-between items-start"},r.a.createElement("div",null,r.a.createElement("div",{className:"flex items-center gap-2 mb-2"},r.a.createElement("span",{className:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 text-xs font-medium px-2 py-1 rounded"},"#",t+1)),r.a.createElement("h3",{className:"font-medium text-lg dark:text-white"},e.name)),r.a.createElement("div",{className:"flex space-x-2"},r.a.createElement("button",{onClick:()=>N(e),className:"text-blue-600 hover:bg-blue-50 dark:text-blue-400 dark:hover:bg-blue-900/30 p-1 rounded"},r.a.createElement(i.d,{className:"h-5 w-5"})),r.a.createElement("button",{onClick:()=>k(e.id),className:"text-red-600 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/30 p-1 rounded"},r.a.createElement(i.b,{className:"h-5 w-5"}))))))))),r.a.createElement(b,{isOpen:E,onClose:()=>{h(!1)},onCityCreated:()=>{w(e=>e+1)}}),x&&r.a.createElement(y,{isOpen:g,onClose:()=>{f(!1),v(null)},onCityUpdated:()=>{w(e=>e+1),u.a.success("City updated successfully")},cityData:x}))}},40:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return d})),a.d(t,"g",(function(){return u}));var n=a(109);let r="https://rms-v2.duckdns.org/api";console.log("Running in Production Mode"),r="https://rms-v2.duckdns.org/api";const l=n.a.create({baseURL:r,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{const t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,async e=>(e.response&&401===e.response.status&&(localStorage.clear(),window.location.href="/"),Promise.reject(e)));const c=async(e,t)=>l.get(e,{params:t}).then(e=>e.data),s=async(e,t)=>l.post(e,t).then(e=>e.data),o=async(e,t)=>l.put(e,t).then(e=>e.data),i=async(e,t)=>l.patch(e,t).then(e=>e.data),m=async e=>l.delete(e).then(e=>e.data),d=async(e,t)=>{try{const a=await l.get(e,{responseType:"blob"}),n=new Blob([a.data],{type:"application/pdf"}),r=window.URL.createObjectURL(n),c=document.createElement("a");c.href=r,c.setAttribute("download",t),document.body.appendChild(c),c.click(),c.remove(),window.URL.revokeObjectURL(r)}catch(a){throw console.error("Download failed:",a),a}},u=async(e,t)=>{try{return(await l.post(e,t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(a){throw console.error("File upload failed:",a),a}}},45:function(e,t,a){"use strict";var n=a(0),r=a.n(n);t.a=function(e){let{children:t}=e;return r.a.createElement("h1",{className:"my-6 text-2xl font-semibold text-gray-700 dark:text-gray-200"},t)}}}]);
//# sourceMappingURL=16.17ceb10a.chunk.js.map