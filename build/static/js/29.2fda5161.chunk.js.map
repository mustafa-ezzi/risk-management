{"version":3,"sources":["components/CreateMiqaatMenuModal.js","pages/MiqaatMenu.js","api/axios.js"],"names":["CreateMiqaatMenuModal","_ref","isOpen","onClose","miqaatId","onSuccess","existingMenuItems","formData","setFormData","useState","miqaat","menu","description","dropdownOptions","setDropdownOptions","menus","isSubmitting","setIsSubmitting","error","setError","useEffect","async","filteredMenus","get","filter","some","existingItem","menu_id","id","err","console","fetchDropdownOptions","handleInputChange","e","name","value","target","prev","_objectSpread","handleSubmit","preventDefault","submissionData","parseInt","response","post","toast","success","_err$response","_err$response$data","errorMessage","data","message","React","createElement","Modal","ModalHeader","ModalBody","className","role","onSubmit","Label","Select","onChange","required","length","disabled","map","key","concat","Textarea","placeholder","rows","ModalFooter","Button","onClick","block","size","MiqaatMenu","_menuData$miqaat_menu","_menuData$miqaat_menu2","useParams","history","useHistory","menuData","setMenuData","isLoading","setIsLoading","miqaatDetails","setMiqaatDetails","isModalOpen","setIsModalOpen","expandedItem","setExpandedItem","fetchMiqaatMenuData","handleDeleteMenuItem","window","confirm","_delete","menuItemId","prevData","miqaat_menu","item","toggleExpand","menu_name","fileInputRef","useRef","src","logo","alt","style","top","left","position","transform","width","maxWidth","height","opacity","zIndex","handleBackClick","goBack","AiOutlineArrowLeft","fontSize","innerWidth","miqaat_name","handleAddMenu","FaPlus","_fileInputRef$current3","current","click","FaUpload","type","accept","ref","_fileInputRef$current","_fileInputRef$current2","file","files","FormData","append","_res$data","_res$data$errors","res","uploadFormData","errors","errorMessages","row","join","duration","warn","_error$response","_error$response$data","Fragment","TableContainer","Table","TableHeader","TableCell","TableBody","index","TableRow","AiOutlineDelete","stopPropagation","AiOutlineDown","menu_description","handleModalClose","handleMenuCreated","BASE_URL","log","axiosInstance","axios","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","Promise","reject","status","clear","location","href","url","params","then","put","patch","delete","downloadBlob","filename","responseType","blob","Blob","blobUrl","URL","createObjectURL","link","document","setAttribute","body","appendChild","remove","revokeObjectURL"],"mappings":"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","file":"static/js/29.2fda5161.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  Modal,\r\n  ModalHeader,\r\n  ModalBody,\r\n  ModalFooter,\r\n  Button,\r\n  Label,\r\n  Textarea,\r\n  Select,\r\n} from \"@windmill/react-ui\";\r\nimport { get, post } from \"../api/axios\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nconst CreateMiqaatMenuModal = ({\r\n  isOpen,\r\n  onClose,\r\n  miqaatId,\r\n  onSuccess,\r\n  existingMenuItems,\r\n}) => {\r\n  const [formData, setFormData] = useState({\r\n    miqaat: miqaatId || \"\",\r\n    menu: \"\",\r\n    description: \"\",\r\n  });\r\n\r\n  const [dropdownOptions, setDropdownOptions] = useState({\r\n    menus: [],\r\n  });\r\n\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchDropdownOptions = async () => {\r\n      try {\r\n        // Fetch miqaat and menu lists\r\n        const menusRes = await get(\"/menu/list/\");\r\n\r\n        const filteredMenus = menusRes.filter(\r\n          (menu) =>\r\n            !existingMenuItems.some(\r\n              (existingItem) => existingItem.menu_id === menu.id\r\n            )\r\n        );\r\n\r\n        setDropdownOptions({\r\n          menus: filteredMenus,\r\n        });\r\n      } catch (err) {\r\n        console.error(\"Error fetching dropdown options:\", err);\r\n        setError(\"Failed to load dropdown options\");\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      fetchDropdownOptions();\r\n    }\r\n  }, [isOpen, existingMenuItems]);\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setIsSubmitting(true);\r\n    setError(null);\r\n\r\n    try {\r\n      // Validate required fields\r\n      if (!formData.miqaat || !formData.menu) {\r\n        setError(\"Please select both Miqaat and Menu items\");\r\n        setIsSubmitting(false);\r\n        return;\r\n      }\r\n\r\n      // Prepare submission data\r\n      const submissionData = {\r\n        miqaat: parseInt(formData.miqaat),\r\n        menu: parseInt(formData.menu),\r\n        description: formData.description || \"\",\r\n      };\r\n\r\n      // Submit the form\r\n      const response = await post(\"/miqaat-menu/\", submissionData);\r\n\r\n      // Call success callback\r\n      onSuccess(response);\r\n\r\n      // Reset form\r\n      setFormData({\r\n        miqaat: miqaatId || \"\",\r\n        menu: \"\",\r\n      });\r\n      onClose();\r\n\r\n      toast.success(\"Menu item added successfully\");\r\n    } catch (err) {\r\n      console.error(\"Error creating miqaat menu record:\", err);\r\n      const errorMessage =\r\n        err.response?.data?.message || \"Failed to create menu record\";\r\n      setError(errorMessage);\r\n      toast.error(errorMessage);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal isOpen={isOpen} onClose={onClose}>\r\n      <ModalHeader>Add Menu Item</ModalHeader>\r\n      <ModalBody>\r\n        {error && (\r\n          <div\r\n            className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4\"\r\n            role=\"alert\"\r\n          >\r\n            <span className=\"block sm:inline\">{error}</span>\r\n          </div>\r\n        )}\r\n        <form onSubmit={handleSubmit}>\r\n          <div className=\"grid grid-cols-1 gap-4\">\r\n            {/* Menu Dropdown */}\r\n            <Label className=\"block text-sm\">\r\n              <span className=\"text-gray-700 dark:text-gray-400\">\r\n                Menu Item\r\n              </span>\r\n              <Select\r\n                name=\"menu\"\r\n                value={formData.menu}\r\n                onChange={handleInputChange}\r\n                className=\"mt-1\"\r\n                required\r\n              >\r\n                <option value=\"\">Select Menu Item</option>\r\n                {dropdownOptions.menus.length === 0 ? (\r\n                  <option disabled>No available menu items</option>\r\n                ) : (\r\n                  dropdownOptions.menus.map((menu) => (\r\n                    <option key={menu.id} value={menu.id}>\r\n                      {menu.name || `Menu #${menu.id}`}\r\n                    </option>\r\n                  ))\r\n                )}\r\n              </Select>\r\n            </Label>\r\n            <Label>\r\n              <span>Description</span>\r\n              <Textarea\r\n                className=\"mt-1\"\r\n                name=\"description\"\r\n                value={formData.description}\r\n                placeholder=\"Enter Description\"\r\n                rows=\"3\"\r\n                onChange={handleInputChange}\r\n              />\r\n            </Label>{\" \"}\r\n          </div>\r\n        </form>\r\n      </ModalBody>\r\n      <ModalFooter>\r\n        <div className=\"hidden sm:block\">\r\n          <Button\r\n            onClick={handleSubmit}\r\n            disabled={isSubmitting || dropdownOptions.menus.length === 0}\r\n          >\r\n            {isSubmitting ? \"Saving...\" : \"Save\"}\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Mobile Buttons */}\r\n        <div className=\"w-full sm:hidden\">\r\n          <Button\r\n            block\r\n            size=\"large\"\r\n            onClick={handleSubmit}\r\n            disabled={isSubmitting || dropdownOptions.menus.length === 0}\r\n          >\r\n            {isSubmitting ? \"Saving...\" : \"Save\"}\r\n          </Button>\r\n        </div>\r\n      </ModalFooter>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default CreateMiqaatMenuModal;\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { useParams, useHistory } from \"react-router-dom\";\r\nimport { get, _delete, uploadFormData } from \"../api/axios\";\r\nimport { FaUpload, FaPlus } from \"react-icons/fa\";\r\n\r\nimport {\r\n  AiOutlineArrowLeft,\r\n  AiOutlineDown,\r\n  AiOutlineDelete,\r\n} from \"react-icons/ai\";\r\nimport toast from \"react-hot-toast\";\r\nimport {\r\n  Table,\r\n  TableHeader,\r\n  TableCell,\r\n  TableBody,\r\n  TableRow,\r\n  TableContainer,\r\n} from \"@windmill/react-ui\";\r\nimport CreateMiqaatMenuModal from \"../components/CreateMiqaatMenuModal\";\r\nimport logo from '../assets/img/mainLogo.png';\r\n\r\nfunction MiqaatMenu() {\r\n  const { id } = useParams();\r\n  const history = useHistory();\r\n\r\n  const [menuData, setMenuData] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [miqaatDetails, setMiqaatDetails] = useState(null);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [expandedItem, setExpandedItem] = useState(null);\r\n\r\n  useEffect(() => {\r\n    fetchMiqaatMenuData();\r\n  }, [id]);\r\n\r\n  const fetchMiqaatMenuData = async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await get(`/miqaat-menu/${id}/`);\r\n      setMenuData(response);\r\n    } catch (err) {\r\n      console.error(\"Error fetching menu data:\", err);\r\n      setError(\"Failed to load menu data. Please try again.\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteMenuItem = async (menuItemId) => {\r\n    try {\r\n      const confirmDelete = window.confirm(\r\n        \"Are you sure you want to delete this menu item?\"\r\n      );\r\n\r\n      if (confirmDelete) {\r\n        await _delete(`/miqaat-menu/${menuItemId}/`);\r\n\r\n        setMenuData((prevData) => ({\r\n          ...prevData,\r\n          miqaat_menu: prevData.miqaat_menu.filter(\r\n            (item) => item.id !== menuItemId\r\n          ),\r\n        }));\r\n\r\n        toast.success(\"Menu item deleted successfully\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error deleting menu item:\", error);\r\n      toast.error(\"Failed to delete menu item. Please try again.\");\r\n    }\r\n  };\r\n\r\n  const handleBackClick = () => {\r\n    history.goBack();\r\n  };\r\n\r\n  const handleAddMenu = () => {\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleModalClose = () => {\r\n    setIsModalOpen(false);\r\n  };\r\n\r\n  const handleMenuCreated = () => {\r\n    fetchMiqaatMenuData();\r\n  };\r\n\r\n  const toggleExpand = (id) => {\r\n    setExpandedItem(expandedItem === id ? null : id);\r\n  };\r\n\r\n  const existingMenuItems =\r\n    menuData?.miqaat_menu?.map((item) => ({\r\n      menu_id: item.menu_id,\r\n      menu_name: item.menu_name,\r\n    })) || [];\r\n\r\n  const fileInputRef = useRef(null);\r\n\r\n  const handleMenuCSVUpload = async () => {\r\n    const file = fileInputRef.current?.files?.[0];\r\n    if (!file) return;\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"file\", file);\r\n\r\n    try {\r\n      const res = await uploadFormData(\"/upload-menu\", formData);\r\n\r\n      if (res.message) {\r\n        toast.success(res.data.message);\r\n      }\r\n      fetchMiqaatMenuData();\r\n\r\n      if (res.data?.errors?.length) {\r\n        const errorMessages = res.data.errors\r\n          .map((err) => `Row ${err.row}: ${err.error}`)\r\n          .join(\"\\n\");\r\n\r\n        toast.error(`⚠️ Errors:\\n${errorMessages}`, { duration: 8000 });\r\n        console.warn(\"CSV upload issues:\", res.data.errors);\r\n      }\r\n    } catch (error) {\r\n      if (error.response?.data?.errors) {\r\n        const errorMessages = error.response.data.errors\r\n          .map((err) => `Row ${err.row}: ${err.error}`)\r\n          .join(\"\\n\");\r\n\r\n        toast.error(`⚠️ Upload failed:\\n${errorMessages}`, { duration: 8000 });\r\n      } else {\r\n        toast.error(\"❌ Upload failed: \" + (error.message || \"Unknown error\"));\r\n      }\r\n    } finally {\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = null;\r\n      }\r\n    }\r\n  };\r\n  return (\r\n      <div className=\"relative w-full px-4 py-6\">\r\n            {/* Watermark Logo */}\r\n        <img\r\n          src={logo}\r\n          alt=\"Watermark\"\r\n          className=\"absolute pointer-events-none select-none\"\r\n          style={{\r\n            top: \"50%\",\r\n            left: \"50%\",\r\n            position: \"absolute\",\r\n            transform: \"translate(-50%, -50%)\",\r\n            width: \"70vw\",\r\n            maxWidth: \"400px\",\r\n            height: \"auto\",\r\n            opacity: 0.05,\r\n            zIndex: 0,\r\n          }}\r\n        />\r\n        \r\n            {/* Content Overlay */}\r\n            <div className=\"relative z-10\">\r\n      <div className=\"flex flex-col sm:flex-row sm:justify-between items-start sm:items-center mb-6 gap-4\">\r\n        <div className=\"flex items-center\">\r\n          <button onClick={handleBackClick} className=\"mr-4\">\r\n            <AiOutlineArrowLeft className=\"w-5 h-5 dark:text-white\" />\r\n          </button>\r\n          <h1\r\n            style={{\r\n              fontSize: window.innerWidth < 768 ? \"1.25rem\" : \"1.5rem\",\r\n            }}\r\n            className=\"font-semibold dark:text-white\"\r\n          >\r\n            Miqaat Menu\r\n            {miqaatDetails && ` - ${miqaatDetails.miqaat_name}`}\r\n          </h1>\r\n        </div>\r\n\r\n        <div className=\"flex gap-4\">\r\n          <button\r\n            className=\"bg-purple-600 hover:bg-purple-700 text-white text-sm sm:text-base px-4 py-2 rounded flex items-center justify-center w-full sm:w-auto\"\r\n            onClick={handleAddMenu}\r\n          >\r\n            <FaPlus className=\"mr-2\" /> Create\r\n          </button>\r\n\r\n          <button\r\n            className=\"bg-green-600 hover:bg-green-700 text-white text-sm sm:text-base px-4 py-2 rounded flex items-center justify-center w-full sm:w-[10px]\"\r\n            onClick={() => fileInputRef.current?.click()}\r\n          >\r\n            <FaUpload className=\"mr-2\" /> Upload CSV\r\n          </button>\r\n\r\n          {/* Hidden file input */}\r\n          <input\r\n            type=\"file\"\r\n            accept=\".csv\"\r\n            ref={fileInputRef}\r\n            onChange={handleMenuCSVUpload}\r\n            className=\"hidden\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {isLoading ? (\r\n        <div className=\"flex justify-center my-8\">\r\n          <p className=\"text-gray-700 dark:text-300\">Loading data...</p>\r\n        </div>\r\n      ) : error ? (\r\n        <div className=\"text-center py-8\">\r\n          <p className=\"text-red-600\">{error}</p>\r\n          <button\r\n            onClick={fetchMiqaatMenuData}\r\n            className=\"mt-4 bg-purple-600 text-white px-4 py-2 rounded\"\r\n          >\r\n            Retry\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* Desktop Table - Hidden on mobile */}\r\n          <TableContainer className=\"hidden md:block mb-8\">\r\n            <Table>\r\n              <TableHeader>\r\n                <tr>\r\n                  <TableCell>ID</TableCell>\r\n                  <TableCell>MENU NAME</TableCell>\r\n                  <TableCell>DESCRIPTION</TableCell>\r\n                  <TableCell className=\"text-right\">ACTIONS</TableCell>\r\n                </tr>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {menuData?.miqaat_menu?.map((item, index) => (\r\n                  <TableRow key={item.id}>\r\n                    <TableCell>\r\n                      <span className=\"text-sm\">{index + 1}</span>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <span className=\"text-sm font-medium\">\r\n                        {item.menu_name}\r\n                      </span>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <span className=\"text-sm\">{item.description}</span>\r\n                    </TableCell>\r\n                    <TableCell className=\"text-right\">\r\n                      <button\r\n                        onClick={() => handleDeleteMenuItem(item.id)}\r\n                        className=\"text-gray-600 hover:text-red-600\"\r\n                      >\r\n                        <AiOutlineDelete className=\"h-4 w-4 inline-block\" />\r\n                      </button>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          </TableContainer>\r\n\r\n          {/* Mobile View - Card Based Layout */}\r\n          <div className=\"md:hidden space-y-3\">\r\n            {!menuData?.miqaat_menu || menuData.miqaat_menu.length === 0 ? (\r\n              <div className=\"text-center py-8\">\r\n                <p className=\"text-gray-700 dark:text-gray-400\">\r\n                  No menu items found\r\n                </p>\r\n              </div>\r\n            ) : (\r\n              menuData.miqaat_menu.map((item, index) => (\r\n                <div\r\n                  key={item.id}\r\n                  className=\"bg-white dark:bg-gray-800 rounded-lg shadow-md border dark:border-gray-700\"\r\n                >\r\n                  <div\r\n                    className=\"flex items-center justify-between p-4 cursor-pointer\"\r\n                    onClick={() => toggleExpand(item.id)}\r\n                  >\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className=\"bg-gray-100 dark:bg-gray-700 h-8 w-8 rounded-full flex items-center justify-center text-gray-700 dark:text-gray-300 font-medium\">\r\n                        {index + 1}\r\n                      </div>\r\n                      <div className=\"font-medium text-gray-800 dark:text-gray-200\">\r\n                        {item.menu_name}\r\n                      </div>\r\n                    </div>\r\n                    <button\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        toggleExpand(item.id);\r\n                      }}\r\n                      className=\"text-gray-600 dark:text-gray-400\"\r\n                    >\r\n                      <AiOutlineDown\r\n                        className={`h-4 w-4 transition-transform ${\r\n                          expandedItem === item.id ? \"rotate-180\" : \"\"\r\n                        }`}\r\n                      />\r\n                    </button>\r\n                  </div>\r\n\r\n                  {expandedItem === item.id && (\r\n                    <div className=\"px-4 pb-4 pt-0 border-t dark:border-gray-700\">\r\n                      <div className=\"mt-2\">\r\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">\r\n                          Description:\r\n                        </p>\r\n                        <p className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n                          {item.menu_description}\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"mt-4 flex justify-end\">\r\n                        <button\r\n                          onClick={() => handleDeleteMenuItem(item.id)}\r\n                          className=\"text-white px-4 py-1 rounded-md bg-red-600 hover:bg-red-700 flex items-center\"\r\n                        >\r\n                          <AiOutlineDelete className=\"h-4 w-4 mr-1\" />\r\n                          Delete\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ))\r\n            )}\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {isModalOpen && (\r\n        <CreateMiqaatMenuModal\r\n          isOpen={isModalOpen}\r\n          onClose={handleModalClose}\r\n          miqaatId={id}\r\n          onSuccess={handleMenuCreated}\r\n          existingMenuItems={existingMenuItems}\r\n        />\r\n      )}\r\n    </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MiqaatMenu;\r\n","import axios from \"axios\";\r\n\r\n// let BASE_URL = \"http://35.172.211.35/api\";\r\nlet BASE_URL = \"https://rms-v2.duckdns.org/api\";\r\n\r\n\r\n\r\nif (process.env.NODE_ENV === \"production\") {\r\n  console.log(\"Running in Production Mode\");\r\n  BASE_URL = \"https://rms-v2.duckdns.org/api\";\r\n} else {\r\n  // BASE_URL = \"http://localhost:8000/api/v1\";\r\n  console.log(\"Running in Development Mode\");\r\n}\r\n\r\nconst axiosInstance = axios.create({\r\n  baseURL: BASE_URL,\r\n  headers: {\r\n    \"Content-Type\": \"application/json\",\r\n  },\r\n});\r\n\r\naxiosInstance.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem(\"accessToken\");\r\n    if (token) {\r\n      config.headers[\"Authorization\"] = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\naxiosInstance.interceptors.response.use(\r\n  (response) => response,\r\n  async (error) => {\r\n    // await logErrorToBackend(error);\r\n    if (error.response && error.response.status === 401) {\r\n      localStorage.clear();\r\n      window.location.href = \"/\";\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport const get = async (url, params) => {\r\n  return axiosInstance.get(url, { params }).then((res) => res.data);\r\n};\r\n\r\nexport const post = async (url, data) => {\r\n  return axiosInstance.post(url, data).then((res) => res.data);\r\n};\r\n\r\nexport const put = async (url, data) => {\r\n  return axiosInstance.put(url, data).then((res) => res.data);\r\n};\r\n\r\nexport const patch = async (url, data) => {\r\n  return axiosInstance.patch(url, data).then((res) => res.data);\r\n};\r\n\r\nexport const _delete = async (url) => {\r\n  return axiosInstance.delete(url).then((res) => res.data);\r\n};\r\n\r\nexport const downloadBlob = async (url, filename) => {\r\n  try {\r\n    const response = await axiosInstance.get(url, {\r\n      responseType: \"blob\",\r\n    });\r\n\r\n    const blob = new Blob([response.data], { type: \"application/pdf\" });\r\n    const blobUrl = window.URL.createObjectURL(blob);\r\n\r\n    const link = document.createElement(\"a\");\r\n    link.href = blobUrl;\r\n    link.setAttribute(\"download\", filename);\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    link.remove();\r\n    window.URL.revokeObjectURL(blobUrl);\r\n  } catch (err) {\r\n    console.error(\"Download failed:\", err);\r\n    throw err;\r\n  }\r\n};\r\n\r\nexport const uploadFormData = async (url, formData) => {\r\n  try {\r\n    const response = await axiosInstance.post(url, formData, {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    });\r\n    return response.data;\r\n  } catch (err) {\r\n    console.error(\"File upload failed:\", err);\r\n    throw err;\r\n  }\r\n};\r\n\r\nexport default axiosInstance;\r\n"],"sourceRoot":""}