{"version":3,"sources":["api/axios.js","assets/img/mainLogo.png","assets/img/mainLogo-dark.png","components/Footer.js","pages/Login.js"],"names":["BASE_URL","console","log","axiosInstance","axios","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","concat","error","Promise","reject","response","async","status","clear","window","location","href","get","url","params","then","res","data","post","put","patch","_delete","delete","downloadBlob","filename","responseType","blob","Blob","type","blobUrl","URL","createObjectURL","link","document","createElement","setAttribute","body","appendChild","click","remove","revokeObjectURL","err","uploadFormData","formData","module","exports","Footer","currentYear","Date","getFullYear","React","style","bottom","left","right","color","textAlign","padding","fontSize","zIndex","background","className","target","rel","fontWeight","textDecoration","cursor","onMouseOver","e","onMouseOut","Login","useHistory","credentials","setCredentials","useState","username","password","setError","isLoading","setIsLoading","showPassword","setShowPassword","unitData","setInfoData","handleChange","name","value","prev","_objectSpread","Fragment","onSubmit","preventDefault","access","setItem","refresh","user","JSON","stringify","role","fetchInofData","redirectPath","_err$response","_err$response$data","detail","src","logoLight","alt","logoDark","HelperText","valid","Label","Input","onChange","placeholder","onClick","togglePasswordVisibility","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","Button","block","disabled"],"mappings":"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","file":"static/js/11.f722ad08.chunk.js","sourcesContent":["import axios from \"axios\";\r\n\r\n// let BASE_URL = \"http://35.172.211.35/api\";\r\nlet BASE_URL = \"https://rms-v2.duckdns.org/api\";\r\n\r\n\r\n\r\nif (process.env.NODE_ENV === \"production\") {\r\n  console.log(\"Running in Production Mode\");\r\n  BASE_URL = \"https://rms-v2.duckdns.org/api\";\r\n} else {\r\n  // BASE_URL = \"http://localhost:8000/api/v1\";\r\n  console.log(\"Running in Development Mode\");\r\n}\r\n\r\nconst axiosInstance = axios.create({\r\n  baseURL: BASE_URL,\r\n  headers: {\r\n    \"Content-Type\": \"application/json\",\r\n  },\r\n});\r\n\r\naxiosInstance.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem(\"accessToken\");\r\n    if (token) {\r\n      config.headers[\"Authorization\"] = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\naxiosInstance.interceptors.response.use(\r\n  (response) => response,\r\n  async (error) => {\r\n    // await logErrorToBackend(error);\r\n    if (error.response && error.response.status === 401) {\r\n      localStorage.clear();\r\n      window.location.href = \"/\";\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport const get = async (url, params) => {\r\n  return axiosInstance.get(url, { params }).then((res) => res.data);\r\n};\r\n\r\nexport const post = async (url, data) => {\r\n  return axiosInstance.post(url, data).then((res) => res.data);\r\n};\r\n\r\nexport const put = async (url, data) => {\r\n  return axiosInstance.put(url, data).then((res) => res.data);\r\n};\r\n\r\nexport const patch = async (url, data) => {\r\n  return axiosInstance.patch(url, data).then((res) => res.data);\r\n};\r\n\r\nexport const _delete = async (url) => {\r\n  return axiosInstance.delete(url).then((res) => res.data);\r\n};\r\n\r\nexport const downloadBlob = async (url, filename) => {\r\n  try {\r\n    const response = await axiosInstance.get(url, {\r\n      responseType: \"blob\",\r\n    });\r\n\r\n    const blob = new Blob([response.data], { type: \"application/pdf\" });\r\n    const blobUrl = window.URL.createObjectURL(blob);\r\n\r\n    const link = document.createElement(\"a\");\r\n    link.href = blobUrl;\r\n    link.setAttribute(\"download\", filename);\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    link.remove();\r\n    window.URL.revokeObjectURL(blobUrl);\r\n  } catch (err) {\r\n    console.error(\"Download failed:\", err);\r\n    throw err;\r\n  }\r\n};\r\n\r\nexport const uploadFormData = async (url, formData) => {\r\n  try {\r\n    const response = await axiosInstance.post(url, formData, {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    });\r\n    return response.data;\r\n  } catch (err) {\r\n    console.error(\"File upload failed:\", err);\r\n    throw err;\r\n  }\r\n};\r\n\r\nexport default axiosInstance;\r\n","module.exports = __webpack_public_path__ + \"static/media/mainLogo.a5300d04.png\";","module.exports = __webpack_public_path__ + \"static/media/mainLogo-dark.23ec9225.png\";","import React from 'react';\r\n\r\nconst Footer = () => {\r\n    const currentYear = new Date().getFullYear();\r\n\r\n    return (\r\n        <footer style={{\r\n            bottom: 0,\r\n            left: 0,\r\n            right: 0,\r\n            color: '#9CA3AF',\r\n            textAlign: 'center',\r\n            padding: '0.75rem',\r\n            fontSize: '0.875rem',\r\n            zIndex: 0,\r\n            // background: \"linear-gradient(45deg, #000000, #300030, #4d0014, #200020)\"\r\n            background: \"linear-gradient(ellipse at center, #DC143C 0%, #300040 50%, #000000 80%)\"\r\n            \r\n\r\n        }}\r\n            className=''>\r\n            Â© {currentYear} Designed and Developed By{' '}\r\n            <a\r\n                href=\"https://5cube.io\"\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                style={{\r\n                    fontWeight: 700,\r\n                    color: '#A855F7',\r\n                    textDecoration: 'none',\r\n                    cursor: 'pointer'\r\n                }}\r\n                onMouseOver={(e) => e.target.style.color = '#9333EA'}\r\n                onMouseOut={(e) => e.target.style.color = '#A855F7'}\r\n            >\r\n                5Cube\r\n            </a>\r\n        </footer>\r\n    );\r\n};\r\n\r\nexport default Footer;","import React, { useState, useEffect } from 'react'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport { Label, Input, Button, HelperText } from '@windmill/react-ui'\r\nimport { get, post } from '../api/axios'\r\nimport Footer from \"../components/Footer\";\r\nimport logoLight from '../assets/img/mainLogo.png';\r\nimport logoDark from '../assets/img/mainLogo-dark.png';\r\n\r\n\r\nfunction Login() {\r\n  const history = useHistory();\r\n  const [credentials, setCredentials] = useState({\r\n    username: '',\r\n    password: ''\r\n  });\r\n  const [error, setError] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [showPassword, setShowPassword] = useState(false); // New state for password visibility\r\n  const [unitData, setInfoData] = useState([]);\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setCredentials(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n  };\r\n\r\n  const fetchInofData = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const response = await get('/users/me');\r\n\r\n      if (response?.role) {\r\n        localStorage.setItem(\"role\", response.role);\r\n      }\r\n\r\n      setInfoData(response);\r\n    } catch (err) {\r\n      console.error('Error fetching permissions data:', err);\r\n      setError('Failed to load permissions data');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n\r\n  const togglePasswordVisibility = () => {\r\n    setShowPassword(prev => !prev);\r\n  };\r\n  \r\nconst handleSubmit = async (e) => {\r\n  e.preventDefault();\r\n  setError('');\r\n\r\n  if (!credentials.username || !credentials.password) {\r\n    setError('username and password are required');\r\n    return;\r\n  }\r\n\r\n  setIsLoading(true);\r\n\r\n  try {\r\n    const response = await post('/users/login/', {\r\n      username: credentials.username,\r\n      password: credentials.password,\r\n    });\r\n\r\n    if (response) {\r\n      if (response.access) {\r\n        localStorage.setItem('accessToken', response.access);\r\n      }\r\n      if (response.refresh) {\r\n        localStorage.setItem('refreshToken', response.refresh);\r\n      }\r\n      if (response.user) {\r\n        localStorage.setItem('user', JSON.stringify(response.user));\r\n        localStorage.setItem('role', response.user.role); // Save role directly from login response\r\n      }\r\n    }\r\n\r\n    // Fetch additional user info & role from /users/me if you need to update or verify\r\n    // Await here to make sure it's done before redirecting\r\n    await fetchInofData();\r\n\r\n    // Now get the role from localStorage (should be set by either login or fetchInofData)\r\n    const role = localStorage.getItem('role');\r\n    let redirectPath = '/app/request'; // default for admin\r\n\r\n    if (role === 'super_admin') {\r\n      redirectPath = '/app/users';\r\n    }\r\n\r\n    // history.push(redirectPath);\r\n\r\n  } catch (err) {\r\n    console.error('Login error:', err);\r\n    setError(\r\n      err?.response?.data?.detail || 'Invalid username or password. Please try again.'\r\n    );\r\n  } finally {\r\n    setIsLoading(false);\r\n  }\r\n};\r\n\r\n\r\n\r\n  return (\r\n    <>\r\n      <div className=\"flex items-center min-h-screen p-6 bg-gray-50 dark:bg-gray-900\">\r\n        <div className=\"flex-1 h-full max-w-md mx-auto overflow-hidden bg-white rounded-lg shadow-xl dark:bg-gray-800\">\r\n          <div className=\"overflow-y-auto\">\r\n            <main className=\"flex items-center justify-center p-6 sm:p-12 md:w-full\">\r\n              <form className=\"w-full\" onSubmit={handleSubmit}>\r\n                <div className=\"flex justify-center items-center\">\r\n  {/* Light Mode Logo */}\r\n  <img\r\n    src={logoLight}\r\n    alt=\"Logo Light\"\r\n    className=\"h-20 w-auto dark:hidden\"\r\n  />\r\n\r\n  {/* Dark Mode Logo */}\r\n  <img\r\n    src={logoDark}\r\n    alt=\"Logo Dark\"\r\n    className=\"h-20 w-auto hidden dark:block\"\r\n  />\r\n</div>\r\n                <h1 className=\"mb-4 text-xl font-semibold text-gray-700 dark:text-gray-200\">Login</h1>\r\n\r\n                {error && (\r\n                  <HelperText className=\"mb-4\" valid={false}>\r\n                    {error}\r\n                  </HelperText>\r\n                )}\r\n\r\n                <Label>\r\n                  <Input\r\n                    className=\"mt-1\"\r\n                    name=\"username\"\r\n                    value={credentials.username}\r\n                    onChange={handleChange}\r\n                    placeholder=\"username\"\r\n                  />\r\n                </Label>\r\n\r\n                <Label className=\"mt-4\">\r\n                  <div className=\"relative\">\r\n                    <Input\r\n                      className=\"mt-1 pr-10\"\r\n                      type={showPassword ? \"text\" : \"password\"}\r\n                      name=\"password\"\r\n                      value={credentials.password}\r\n                      onChange={handleChange}\r\n                      placeholder=\"Password\"\r\n                    />\r\n                    <button\r\n                      type=\"button\"\r\n                      className=\"absolute inset-y-0 right-0 flex items-center pr-3 focus:outline-none focus:ring-0\"\r\n                      onClick={togglePasswordVisibility}\r\n                    >\r\n                      {showPassword ? (\r\n                        <svg className=\"h-5 w-5 focus:outline-none focus:ring-0 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.79m0 0L21 21\" />\r\n                        </svg>\r\n                      ) : (\r\n                        <svg className=\"h-5 w-5 focus:outline-none focus:ring-0 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\r\n                        </svg>\r\n                      )}\r\n                    </button>\r\n                  </div>\r\n                </Label>\r\n\r\n                <Button\r\n                  className=\"mt-4\"\r\n                  block\r\n                  type=\"submit\"\r\n                  disabled={isLoading}\r\n                >\r\n                  {isLoading ? 'Logging in...' : 'Log in'}\r\n                </Button>\r\n\r\n              </form>\r\n            </main>\r\n          </div>\r\n          <hr />\r\n          <Footer />\r\n        </div>\r\n\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Login"],"sourceRoot":""}